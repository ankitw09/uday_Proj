<section class="product_section layout_padding">
   <div class="container">
      <div class="heading_container heading_center">
         <h2>
            Our <span>products</span>
         </h2>
      </div>
      <div class="row">

        <% items.forEach(function(image) { %>

         <div class="col-sm-6 col-md-4 col-lg-4">
            <div class="box">
               <div class="option_container">
                  <div class="options">
                     <a  href="" class="option1">
                        Stylish Specs
                     </a>
                     <a href="addCard/<%= image._id %>" class="option2">
                        Buy Now
                     </a>
                  </div>
               </div>
               <div class="img-box">
                   <img src="data:image/<%=image.img.contentType%>;base64,
                   <%=image.img.data.toString('base64')%>" alt="Unable to render">
               </div>
               <div class="detail-box">
                  <h5>
                     Stylish Specs
                  </h5>
                  <h6 >
                     <%= image.price %>
                  </h6>
               </div>
            </div>
            <!-- <a href="cart/<%= image._id %>"> -->
              <button  onclick="addToCart('<%= image._id %>')" class="btn-success">Add To Cart</button> 
      
         </div>
        
         <% }) %>


      </div>
      <div class="btn-box">
         <a href="">
            View All products
         </a>
      </div>
   </div>
</section>

<script>

const addToCart = async (id) => {
  try {
    const response = await fetch(`/cart/${id}`, {
      method: 'POST'
    });
    if (response.ok) {
      alert('Product added to cart successfully!');
      location.reload(); // Refresh the page to show the updated cart
    } else {
      alert('An error occurred while adding product to cart');
    }
  } catch (error) {
    console.log(error);
    alert('An error occurred while adding product to cart');
  }
}

// Example usage: addToCart('product_id_here');

</script>